{
  "attack_paths": [],
  "crown_jewel_ids": [
    "aws_db_instance.prod"
  ],
  "edges": [
    {
      "from_id": "__internet__",
      "meta": null,
      "to_id": "aws_instance.web",
      "type": "network_exposure"
    },
    {
      "from_id": "__internet__",
      "meta": null,
      "to_id": "aws_lb.web",
      "type": "network_exposure"
    },
    {
      "from_id": "aws_iam_role.app",
      "meta": null,
      "to_id": "aws_iam_policy.wide",
      "type": "iam_binding"
    },
    {
      "from_id": "aws_iam_role.app",
      "meta": null,
      "to_id": "aws_iam_policy.wide",
      "type": "iam_binding"
    },
    {
      "from_id": "aws_iam_role.app",
      "meta": null,
      "to_id": "aws_iam_role_policy.inline",
      "type": "iam_binding"
    },
    {
      "from_id": "aws_security_group.backend",
      "meta": null,
      "to_id": "aws_instance.backend",
      "type": "association"
    },
    {
      "from_id": "aws_security_group.web",
      "meta": null,
      "to_id": "aws_instance.web",
      "type": "association"
    },
    {
      "from_id": "aws_security_group.web",
      "meta": null,
      "to_id": "aws_lb.web",
      "type": "association"
    }
  ],
  "findings": [
    {
      "attack_path": [],
      "base_severity": "MEDIUM",
      "breakpoints": [],
      "category": "network",
      "context_severity": "HIGH",
      "description": "Load balancer aws_lb.web is internet-facing.",
      "id": "bfa62673f796",
      "node_id": "aws_lb.web",
      "override_reason": "Reachable from internet but no path to crown jewel",
      "rule_id": "public-lb",
      "shortest_path_length": null,
      "title": "Public load balancer"
    },
    {
      "attack_path": [],
      "base_severity": "HIGH",
      "breakpoints": [],
      "category": "iam",
      "context_severity": "NOISE",
      "description": "IAM policy aws_iam_role_policy.inline grants privilege escalation permissions.",
      "id": "9b49c525152c",
      "node_id": "aws_iam_role_policy.inline",
      "override_reason": "Not reachable from internet",
      "rule_id": "pass-role",
      "shortest_path_length": null,
      "title": "IAM PassRole permission"
    },
    {
      "attack_path": [],
      "base_severity": "HIGH",
      "breakpoints": [],
      "category": "network",
      "context_severity": "NOISE",
      "description": "Security group aws_security_group.web allows ingress from 0.0.0.0/0.",
      "id": "c8d63b7cff07",
      "node_id": "aws_security_group.web",
      "override_reason": "Not reachable from internet",
      "rule_id": "sg-open-to-world",
      "shortest_path_length": null,
      "title": "Security group open to 0.0.0.0/0"
    },
    {
      "attack_path": [],
      "base_severity": "HIGH",
      "breakpoints": [],
      "category": "iam",
      "context_severity": "NOISE",
      "description": "IAM policy aws_iam_policy.wide grants Action: * on Resource: *.",
      "id": "4380a1d2fb48",
      "node_id": "aws_iam_policy.wide",
      "override_reason": "Not reachable from internet",
      "rule_id": "wildcard-iam",
      "shortest_path_length": null,
      "title": "Wildcard IAM action"
    }
  ],
  "nodes": [
    {
      "canonical_actions": [],
      "category": "internet",
      "flags": {
        "crown_jewel": false,
        "internet_facing": false
      },
      "id": "__internet__",
      "kind": "__internet__",
      "meta": null,
      "provider": ""
    },
    {
      "canonical_actions": [],
      "category": "compute",
      "flags": {
        "crown_jewel": false,
        "internet_facing": false
      },
      "id": "aws_autoscaling_group.web",
      "kind": "aws_autoscaling_group",
      "meta": null,
      "provider": "aws"
    },
    {
      "canonical_actions": [],
      "category": "database",
      "flags": {
        "crown_jewel": true,
        "internet_facing": false
      },
      "id": "aws_db_instance.prod",
      "kind": "aws_db_instance",
      "meta": {
        "engine": "postgres",
        "publicly_accessible": false,
        "sg_refs": []
      },
      "provider": "aws"
    },
    {
      "canonical_actions": [
        "secret_read",
        "database_admin",
        "privilege_escalation",
        "storage_read",
        "secret_write",
        "compute_admin",
        "storage_write",
        "network_admin"
      ],
      "category": "identity",
      "flags": {
        "crown_jewel": false,
        "internet_facing": false
      },
      "id": "aws_iam_policy.wide",
      "kind": "aws_iam_policy",
      "meta": {
        "actions": [
          "*"
        ]
      },
      "provider": "aws"
    },
    {
      "canonical_actions": [],
      "category": "identity",
      "flags": {
        "crown_jewel": false,
        "internet_facing": false
      },
      "id": "aws_iam_role.app",
      "kind": "aws_iam_role",
      "meta": {
        "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ec2.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
      },
      "provider": "aws"
    },
    {
      "canonical_actions": [
        "database_admin",
        "privilege_escalation"
      ],
      "category": "identity",
      "flags": {
        "crown_jewel": false,
        "internet_facing": false
      },
      "id": "aws_iam_role_policy.inline",
      "kind": "aws_iam_role_policy",
      "meta": {
        "actions": [
          "rds:*",
          "iam:PassRole"
        ]
      },
      "provider": "aws"
    },
    {
      "canonical_actions": [],
      "category": "compute",
      "flags": {
        "crown_jewel": false,
        "internet_facing": false
      },
      "id": "aws_instance.backend",
      "kind": "aws_instance",
      "meta": {
        "sg_refs": [
          "aws_security_group.backend"
        ]
      },
      "provider": "aws"
    },
    {
      "canonical_actions": [],
      "category": "compute",
      "flags": {
        "crown_jewel": false,
        "internet_facing": true
      },
      "id": "aws_instance.web",
      "kind": "aws_instance",
      "meta": {
        "sg_refs": [
          "aws_security_group.web"
        ]
      },
      "provider": "aws"
    },
    {
      "canonical_actions": [],
      "category": "load_balancer",
      "flags": {
        "crown_jewel": false,
        "internet_facing": true
      },
      "id": "aws_lb.web",
      "kind": "aws_lb",
      "meta": {
        "sg_refs": [
          "aws_security_group.web"
        ]
      },
      "provider": "aws"
    },
    {
      "canonical_actions": [],
      "category": "firewall",
      "flags": {
        "crown_jewel": false,
        "internet_facing": false
      },
      "id": "aws_security_group.backend",
      "kind": "aws_security_group",
      "meta": {
        "ingress_rules": [
          {
            "cidr_blocks": [
              "10.0.0.0/8"
            ],
            "from_port": 5432,
            "ipv6_cidr_blocks": [],
            "protocol": "tcp",
            "source_security_groups": [],
            "to_port": 5432
          }
        ],
        "open_to_world": false
      },
      "provider": "aws"
    },
    {
      "canonical_actions": [],
      "category": "firewall",
      "flags": {
        "crown_jewel": false,
        "internet_facing": false
      },
      "id": "aws_security_group.web",
      "kind": "aws_security_group",
      "meta": {
        "ingress_rules": [
          {
            "cidr_blocks": [
              "0.0.0.0/0"
            ],
            "from_port": 443,
            "ipv6_cidr_blocks": [],
            "protocol": "tcp",
            "source_security_groups": [],
            "to_port": 443
          }
        ],
        "open_to_world": true
      },
      "provider": "aws"
    }
  ],
  "stats": {
    "skipped": 0,
    "supported": 12,
    "total": 12
  }
}
